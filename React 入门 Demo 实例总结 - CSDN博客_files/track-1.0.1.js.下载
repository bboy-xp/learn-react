!function(){var e,t,o,r,n,i,c;n=[],e={SERVER_PV_URL:window.location.protocol+"//pv.csdn.net/csdnbi",SERVER_RE_URL:window.location.protocol+"//re.csdn.net/csdnbi",DELAY:500,DEBUG:!0},r={PV:"pv",VIEW:"view",CLICK:"click"},c={SKIPPED_AND_VISIBLE:"0",VISIBLE:"1"},o={getCookie:function(e){var t,o=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(o))?unescape(t[2]):null},buildRequestData:function(e,t){var o;return o=r.PV==e?{headers:{component:"enterprise",datatype:"track",version:"v1"},body:JSON.stringify({re:$.param(t)})}:{headers:{component:"enterprise",datatype:"re",version:"v1"},body:JSON.stringify({re:$.param(t)})}},serverUrl:function(t){return r==t?e.SERVER_PV_URL:e.SERVER_RE_URL},initData:function(){var e,t;return i={uid:(null!=(e=/(; )?(UserName|_javaeye_cookie_id_)=([^;]+)/.exec(window.document.cookie))?e[3]:void 0)||"-",ref:window.document.referrer,pid:window.location.host.split(".csdn.net")[0],mod:"",con:"",ck:"-",curl:window.location.href,session_id:o.getCookie("dc_session_id"),cfg:{viewStrategy:c.VISIBLE}},$("meta[name=track]").attr("content")&&(t=JSON.parse($("meta[name=track]").attr("content"))),t&&(i=$.extend({},i,t)),i},tos:function(){var e,t,o,r;e=+new Date/1e3|0,o=null!=(t=/\bdc_tos=([^;]*)(?:$|;)/.exec(document.cookie))?t[1]:void 0;try{r=e-parseInt(o,36)}catch(n){console.warn("tos init error",n),r=-1}return document.cookie="dc_tos="+e.toString(36)+" ; expires="+new Date(1e3*(e+14400)).toGMTString()+" ; max-age=14400 ; path=/ ; domain=."+this.topDomain(window.location.host),r},topDomain:function(e){return/\.?([a-z0-9\-]+\.[a-z0-9\-]+)(:\d+)?$/.exec(e)[1]},copyArr:function(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o]);return t},isView:function(e,t){var o=this;if(!e)return!1;var r=this.getElementTop(e),n=r+e.offsetHeight;return c.VISIBLE==t?o.scrollTop()<r&&r<o.scrollTop()+o.windowHeight()||o.scrollTop()<n&&n<o.scrollTop()+o.windowHeight():c.SKIPPED_AND_VISIBLE==t?r<=o.scrollTop()+o.windowHeight()||(o.scrollTop()<r&&r<o.scrollTop()+o.windowHeight()||o.scrollTop()<n&&n<o.scrollTop()+o.windowHeight()):void 0},scrollTop:function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)},windowHeight:function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},getElementTop:function(e){if("undefined"!=typeof jQuery)return $(e).offset().top;var t=e.offsetTop;for(e=e.offsetParent;null!=e;)t+=e.offsetTop,e=e.offsetParent;return t},url2Obj:function(e){var t={},o=e.split("&");for(var r in o)t[o[r].split("=")[0]]=decodeURIComponent(o[r].split("=")[1]);return t}},t={timer:0,checkTimer:0,reportServer:function(t,i){if("undefined"!=typeof t&&"undefined"!=typeof i){var c=o.buildRequestData(t,i);n.push(c)}var a=o.copyArr(n);n=[];var d=r.PV==t?e.SERVER_PV_URL:e.SERVER_RE_URL;$.ajax({url:d,type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"text/plain;charset=UTF-8",data:JSON.stringify(a),success:function(){},error:function(){console.error("csdn.track.reportServer()",arguments)}})},reportServerDelay:function(t,r){var i=o.buildRequestData(t,r);n.push(i);var c=this;c.timer&&clearTimeout(c.timer),c.timer=setTimeout(function(){c.reportServer()},e.DELAY)},reportView:function(e,t){var o=$.extend(!0,{},i,e);o.ck="-",delete o.cfg,o.type=r.VIEW,"undefined"==typeof delay?this.reportServerDelay(r.VIEW,o):this.reportServer(r.VIEW,o),"function"==typeof csdn.afterTrackReportView&&csdn.afterTrackReportView(t,e)},reportClick:function(e){var t=$.extend(!0,{},i,e);t.ck=t.con,delete t.cfg,t.type=r.CLICK,this.reportServer(r.CLICK,t)},reportPageView:function(e){var t=$.extend(!0,{},i,e);t.tos=o.tos(),delete t.cfg,t.type=r.PV,this.reportServer(r.PV,t)},viewCheck:function(){var e=this;clearTimeout(e.checkTimer),e.checkTimer=setTimeout(function(){$("[data-track-view]").each(function(){var e=$(this),t=$.extend({},i,e.data("trackView"));o.isView(e[0],t.cfg.viewStrategy)&&(csdn.track.reportView(t,this),e.removeData("trackView"),e.removeAttr("data-track-view"))})},50)},isView:function(e){return o.isView(e)},debug:function(e,t){var r,n;for(var i in e)n=e[i],r=o.url2Obj(JSON.parse(n.body).re),"undefined"!=typeof t?console.log(r.type,"-->:",n.headers.datatype,r.mod,r.con):console.log(r.type,"-->:",r)}},void 0===window.csdn&&(window.csdn={}),window.csdn.track=t,i=o.initData(),i.disabled||csdn.track.reportPageView()}(),$(function(){var e=csdn.track,t="ontouchend"in document?"tap":"click";$(document).on(t,"[data-track-click]",function(){var t=$(this).data("trackClick");e.reportClick(t)}),e.viewCheck($("[data-track-view]")),$(window).on("scroll",function(){e.viewCheck($("[data-track-view]"))})});